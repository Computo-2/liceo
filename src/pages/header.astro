---
import ItemMenuHeaderMovil from '../components/ItemMenuHeaderMovil.astro';
import ItemMenuHeaderPc from "../components/ItemMenuHeaderPc.astro";
import * as Lucide from "lucide-react";

const items = [
  { href: "#", title: "Información", subtitle: "Más información sobre Liceo.", icon: "Info" },
  { href: "#", title: "Facebook",    subtitle: "Visítanos en Facebook.",                    icon: "Facebook" },
  { href: "#", title: "Tik Tok",     subtitle: "Conoce Liceo a través de videos.", icon: "Video" },
  { href: "#", title: "Ubicación",   subtitle: "Dr. Miguel silva G. 55, Morelia.",          icon: "MapPin" },
  { href: "#", title: "Testimonios", subtitle: "Experiencia de alumnos anteriores.",        icon: "Users" },
];

function getLucide(name: string) {
  return (Lucide as any)[name] || null;
}

---


<script src="https://cdn.jsdelivr.net/npm/@tailwindplus/elements@1" type="module"></script>

  <header class="fixed inset-x-0 top-0 z-30 bg-[#32509c] py-0 md:py-4 lg:py-1 lg:-pb-5 h-17 md:h-30 lg:h-20 shadow-xl border border-white/25">
    <nav aria-label="Principal" class="mx-auto flex max-w-9xl md:max-w-6x1 items-center justify-between px-6 md:px-4 lg:px-12">
      <!-- Logo -->
      <div class="flex lg:flex-1 items-center md:mt-2">
        <a href="#" class="-m-1.5 p-1.5 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 rounded-lg">
          <span class="sr-only" id="app-name">Liceo Michoacano</span>
          <img src="/favicon.gif" alt="Liceo Michoacano" class="h-15 md:h-20 lg:h-15 w-auto" />
        </a>
      </div>

      <!-- Botón hamburguesa (móvil) -->
      <div class="flex lg:hidden">
         <button type="button" data-command="show-modal" data-commandfor="mobile-menu"
           class="-m-2 inline-flex items-center justify-center rounded-md p-4 text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70"
           aria-controls="mobile-menu" aria-expanded="false" aria-label="Abrir menú principal">
           <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true" class="mt-2 w-10 h-10">
           <path d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" stroke-linecap="round" stroke-linejoin="round" />
           </svg>
         </button>
      </div>

      <!-- Menú desktop -->
      <div class="hidden lg:flex lg:items-center lg:gap-x-12">
        <!-- Grupo con popover nativo -->
        <div class="relative">
          <button popovertarget="desktop-menu-product" aria-haspopup="dialog" aria-controls="desktop-menu-product"
                  class="flex items-center gap-x-1 text-lg md:text-xl font-semibold text-white hover:text-blue-200 transition focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 rounded-lg px-1">
            Experiencia Liceo
            <svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="size-5 flex-none opacity-80">
              <path d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" />
            </svg>
          </button>

          <el-popover id="desktop-menu-product" anchor="bottom" popover="manual"
            class="w-screen max-w-md overflow-hidden shadow-xl border border-white/15 rounded-3xl bg-[#32509c] outline outline-1 -outline-offset-1 outline-white/10 [--anchor-gap:--spacing(3)] backdrop:bg-transparent open:block data-closed:translate-y-1 data-closed:opacity-0 data-enter:duration-200 data-enter:ease-out data-leave:duration-150 data-leave:ease-in motion-reduce:transition-none">

            <div class="p-4">
              {items.map((it) => {
                const Icon = getLucide(it.icon);
                return (
               <ItemMenuHeaderPc
                 href={it.href}
                 title={it.title}
                 subtitle={it.subtitle}
                >
               {Icon && (
                <Icon
                  slot="icon"
                  class="size-10 text-xl text-white group-hover:text-white"
               />
               )}
              </ItemMenuHeaderPc>
                 );
               })}
               
            </div>

            <div class="grid grid-cols-2 divide-x divide-white/10 bg-gray-700/50">
              <a href="#" class="group border border-white/15 flex items-center justify-center gap-x-2.5 p-3 text-base md:text-lg font-semibold text-white hover:bg-blue-500/70 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/60">WhatsApp</a>
              <a href="#" class="group border border-white/15 flex items-center justify-center gap-x-2.5 p-3 text-base md:text-lg font-semibold text-white hover:bg-blue-500/70 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/60">Email</a>
            </div>
          </el-popover>
        </div>

        <a href="#" class="text-md md:text-lg font-semibold text-white hover:text-blue-200 hover:underline transition">Agenda tu cita</a>
        <a href="#" class="text-md md:text-lg font-semibold text-white hover:text-blue-200 hover:underline transition">Videos</a>
        <a href="#" class="text-md md:text-lg font-semibold text-white hover:text-blue-200 hover:underline transition">Reseñas</a>

       </div>

      <!-- CTA derecha -->
      <div class="hidden lg:flex lg:flex-1 lg:justify-end">
        <a href="#" class="text-lg md:text-xl font-semibold text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 rounded-lg px-1">Log in <span aria-hidden="true">→</span></a>
      </div>
    </nav>

    <!-- Menú móvil -->
    <div id="mobile-menu" class="hidden shadow-xl border border-white/15 shadow-3xl border border-white fixed inset-x-0 top-0 h-auto z-50 bg-[#32509c] p-4 md:p-4 text-white transition data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=open]:fade-in data-[state=closed]:fade-out">
      <div class="relative mx-auto max-w-6x1">
        <div class="flex items-center justify-between">
          <a href="#" class="p-1.5 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 rounded-lg">
            <span class="sr-only">Liceo Michoacano</span>
            <img src="/favicon.gif" alt="Liceo Michoacano" class="h-15 lg:h-25 w-auto" />
          </a>
          <button type="button" data-command="hide-modal" data-commandfor="mobile-menu"
                  class="h-20 text-white/90 hover:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 rounded-lg p-2"
                  aria-controls="mobile-menu" aria-label="Cerrar menú">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-10 h-10" aria-hidden="true">
              <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </button>
        </div>

        <ul class="mt-10 space-y-6 text-center text-xl font-semibold leading-relaxed">
          <li>
            <!-- Desplegable Product (móvil) -->
            <div class="relative inline-block">
              <button id="product-toggle" class="flex items-center gap-x-1 text-sm md:text-lg font-semibold text-white hover:text-blue-200 transition focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 rounded-lg px-2"
                      aria-controls="product-menu" aria-expanded="false">
                Experiencia Liceo
                <svg viewBox="0 0 20 20" fill="currentColor" class="size-5 opacity-80" aria-hidden="true">
                  <path d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" />
                </svg>
              </button>
              <div id="product-menu"
         class="hidden fixed left-1/2 -translate-x-1/2 top-20 z-[3000]
         w-[min(96vw,40rem)] md:w-[min(92vw,44rem)]
         overflow-hidden rounded-3xl bg-[#32509c]
         outline outline-1 outline-white/10 ring-1 ring-white/10 shadow-2xl">

  <div class="p-3 md:p-4 space-y-4 md:space-y-6">
  <div class="space-y-1">
  {items.map((it) => {
    const Icon = getLucide(it.icon);
    return (
      <ItemMenuHeaderMovil href={it.href} title={it.title} subtitle={it.subtitle}>
        {Icon && (
            <Icon
              slot="icon"
              class="size-15 text-lg text-gray-200 group-hover:text-white"
            />
          )}
      </ItemMenuHeaderMovil>
    );
  })}
</div>
</div>

  <div class="grid grid-cols-2 divide-x divide-white/10 bg-gray-700/50">
    <a href="#"
       class="group shadow-xl border border-white/15 flex items-center justify-center gap-x-2.5
              p-2 md:p-3 text-sm md:text-xl font-semibold text-white
              hover:bg-blue-500/70">WhastApp</a>
    <a href="#"
       class="group shadow-sm border border-white/15 flex items-center justify-center gap-x-2.5
              p-2 md:p-3 text-sm md:text-xl font-semibold text-white
              hover:bg-blue-500/70">Email</a>
  </div>
</div>

            </div>
          </li>
          <li><a href="#" class="hover:text-blue-200 text-sm md:text-lg focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 rounded-lg px-2">Agenda tu cita</a></li>
          <li><a href="#" class="hover:text-blue-200 text-sm md:text-lg focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 rounded-lg px-2">Videos</a></li>
          <li><a href="#" class="hover:text-blue-200 text-sm md:text-lg focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 rounded-lg px-2">Reseñas</a></li>
          <li><a href="#" class="hover:text-blue-200 text-sm md:text-lg focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 rounded-lg px-2">Log in →</a></li>
        </ul>
      </div>
    </div>
  </header>

  <!-- Scripts para que funcione el menu desplegable del header en movil -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const mobileToggle = document.querySelector('[data-command="show-modal"][data-commandfor="mobile-menu"]');
      const mobileClose = document.querySelector('[data-command="hide-modal"][data-commandfor="mobile-menu"]');
      const mobileMenu = document.getElementById('mobile-menu');
      const productToggle = document.getElementById('product-toggle');
      const productMenu = document.getElementById('product-menu');

      const openMobile = () => {
        if (!mobileMenu) return;
        mobileMenu.classList.remove('hidden');
        mobileMenu.setAttribute('data-state', 'open');
        document.body.classList.add('overflow-hidden');
        mobileToggle?.setAttribute('aria-expanded', 'true');
      };

      const closeMobile = () => {
        if (!mobileMenu) return;
        mobileMenu.setAttribute('data-state', 'closed');
        mobileMenu.classList.add('hidden');
        document.body.classList.remove('overflow-hidden');
        mobileToggle?.setAttribute('aria-expanded', 'false');
      };

      mobileToggle?.addEventListener('click', openMobile);
      mobileClose?.addEventListener('click', closeMobile);

      // Cerrar con ESC y clic fuera
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          closeMobile();
          hideProductMenu();
        }
      });

      document.addEventListener('click', (e) => {
        // Menú Product móvil
        if (productToggle && productMenu) {
          if (productToggle.contains(e.target as Node)) {
            const willOpen = productMenu.classList.toggle('hidden');
            productToggle.setAttribute('aria-expanded', (!willOpen).toString());
          } else if (!productMenu.contains(e.target as Node)) {
            hideProductMenu();
          }
        }
      });

      function hideProductMenu() {
        if (!productMenu || !productToggle) return;
        productMenu.classList.add('hidden');
        productToggle.setAttribute('aria-expanded', 'false');
      }
    });
  </script>




